# Telegram File Storage

Проект по созданию программы для хранения файлов в Telegram с помощью бота и канала.

---

## Структура приложения

- **Клиентская часть**
- **Серверная часть**

---

## Серверная часть

Позволяет хранить данные пользователя:

- **логин**
- **пароль**
- **Telegram Bot Token**
- **Telegram Channel ID** (`-100XXXXXXXXXX`)
- **JSON-структура файлов**

### Пример структуры файла (JSON)

```json
[
    {
        "Name": "",
        "VirtualPath": "/",
        "Size": 0,
        "Hash": "",
        "isDeleted": false,
        "PartsCount": 0,
        "fileIds": {
            "0": "",
            "1": "",
            "2": ""
        }
    }
]
```

#### Описание полей

| Поле         | Описание                                                                                   |
|--------------|--------------------------------------------------------------------------------------------|
| Name         | Имя файла                                                                                  |
| VirtualPath  | Путь файла в виртуальной файловой системе                                                  |
| Size         | Размер файла в байтах                                                                      |
| Hash         | Хеш файла (для проверки целостности)                                                       |
| PartsCount   | Количество частей, на которые разбит файл                                                  |
| fileIds      | Список ID файлов (сообщений) для скачивания из Telegram                                    |
| isDeleted    | Флаг удаления файла из виртуальной файловой системы                                        |

### Принцип работы

Обычный API с базой данных для хранения и удобного доступа к информации.

---

## Клиентская часть

Avalonia MVVM проект для отображения файловой структуры (файлы и папки), скачивания и загрузки файлов с Telegram-канала.

### Основные страницы

#### 1. Основная

- Список файлов и папок в виде таблицы.
- Каждая строка — файл или папка с иконкой, названием и размером.
- Фильтрация по полям (кроме картинки).
- Навигация по виртуальной файловой системе.
- Адресная строка виртуального пути.
- Кнопки: **Скачать / Загрузить / Переместить / Удалить / Настройки**.

#### 2. Настройки

- Два столбца: **Карта настроек** / **Настройки**
- Категории:
    - **Основные** (тема, выход, смена пароля)
    - **Telegram** (Bot Token, Channel ID)
    - **Синхронизация** (вкл/выкл сохранения на сервере)
    - **Загрузка** (мультипоточная загрузка, количество потоков, ограничение скорости)
    - **Скачивание** (аналогично загрузке)

#### 3. Приветствие

- Появляется при первом запуске (до завершения настройки)
- Слайды:
    1. Приветствие и описание программы
    2. Соглашение пользователя
    3. Вход / Регистрация / Продолжить без синхронизации
    4. Окно входа или регистрации
    5. Добавление бота (ввод токена)
    6. Информация о создании бота (по желанию)
    7. Добавление канала (ID в формате `-100XXXXXXXXXX`)
    8. Как получить ID канала (2 способа)
    9. Как пригласить бота в канал (проверка наличия бота и прав)
    11. Краткая инструкция (3-5 слайдов с картинками)

---

## Функционал работы с файлами

- **Загрузка файлов**  
    Потоковый процесс: файл разбивается на части до 15 МБ, загружается в канал через бота, сохраняются fileId. При включённой синхронизации — информация о файле отправляется на сервер.

- **Скачивание файлов**  
    Потоковый процесс: скачивание и склейка частей, проверка целостности по хешу.

- **Перемещение**  
    Изменение виртуального пути файла.

- **Удаление**  
    Файл помечается как удалённый (отображается при включённой опции "показывать скрытые"). При повторном удалении — удаляются все части из канала и запись.

---

## Важно

- Загрузка и скачивание должны быть защищены от ошибок, чтобы избежать повреждения файлов.
- Приложение должно быть легко читаемым и масштабируемым.
- Избегать "спагетти-кода".
- Разделять функционал по файлам.
- Приложение должно быть красивым, функциональным и производительным.
- Каждое изменение фиксировать в git.
- Не создавать папки и файлы в корневом коталоге

---

## Правила работы с Copilot
- При изменениях в коде не повторяет существующий код, а использует комментарии // ...existing code... для обозначения неизменённых участков.
- Все изменения вносятся только через инструменты, код напрямую пользователю не выводится.
- Copilot всегда учитывает структуру проекта и специфику C# (.NET, Avalonia, MVVM).